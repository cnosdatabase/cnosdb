include ./setup.slt

##########
## Query
##########


query 
SELECT time, loc, st_AsBinary(loc) FROM gis_loc order by time, loc;
----
1999-12-31T00:00:00 POINT(0 0) 010100000000000000000000000000000000000000
1999-12-31T00:00:00.005 POINT(0 1) 01010000000000000000000000000000000000f03f
1999-12-31T00:00:00.010 POINT(0 2) 010100000000000000000000000000000000000040
1999-12-31T00:00:10.015 POINT(0 3) 010100000000000000000000000000000000000840
1999-12-31T00:00:10.020 POINT(0 4) 010100000000000000000000000000000000001040
1999-12-31T00:10:00.025 POINT(0 5) 010100000000000000000000000000000000001440
1999-12-31T00:10:00.030 POINT(0 6) 010100000000000000000000000000000000001840
1999-12-31T01:00:00.035 POINT(0 7) 010100000000000000000000000000000000001c40

query 
select st_AsBinary(null);
----
NULL

query 
select st_AsBinary('POINT(0 0)');
----
010100000000000000000000000000000000000000

query 
select st_AsBinary('POINT(0, 0)');
----
NULL

query error Arrow error: Io error: Status \{ code: Internal, message: "Build logical plan: Datafusion: Error during planning: The function \\"st_AsBinary\\" expects 1 arguments, but 2 were provided",.*
select st_AsBinary('POINT(0, 0)', null);


query error Arrow error: Io error: Status \{ code: Internal, message: "Build logical plan: Datafusion: Error during planning: The function \\"st_AsBinary\\" expects 1 arguments, but 0 were provided", *
select st_AsBinary();

query 
select st_AsBinary(loc0_point) from gis_loc_all order by time;
----
010100000000000000000000000000000000000000
01010000000000000000000000000000000000f03f
0101000000000000000000f03f0000000000000000
010100000000000000000010400000000000000000
0101000000000000000000f03f0000000000000840
010100000000000000000014400000000000001840
010100000000000000000024400000000000000000
010100000000000000000000000000000000003440
01010000000000000000c05b400000000000607540
010100000000000000000041400000000000003640


query 
select st_AsBinary(loc1_LINESTRING) from gis_loc_all order by time;
----
0102000000030000000000000000d07240000000000040594000000000004059400000000000d0724000000000001079400000000000107940
0102000000030000000000000000f072400000000000c059400000000000c059400000000000f0724000000000003079400000000000307940
0102000000030000000000000000e07240000000000040594000000000008059400000000000e0724000000000000046400000000000804640
0102000000030000000000000000d072400000000000003e400000000000004940000000000000414000000000000045400000000000804640
01020000000300000000000000008041400000000000003240000000000000334000000000000041400000000000003e400000000000407a40
01020000000300000000000000008040400000000000002840000000000000284000000000000042400000000000004e400000000000003e40
01020000000300000000000000000041400000000000003e4000000000008051400000000000004e4000000000008046400000000000805140
0102000000030000000000000000003e400000000000002a400000000000002440000000000000404000000000008044400000000000004640
0102000000030000000000000000003f4000000000000034400000000000002a40000000000000424000000000000049400000000000002440
0102000000030000000000000000003e40000000000000244000000000000024400000000000003e4000000000000044400000000000004440



query 
select st_AsBinary(loc2_POLYGON) from gis_loc_all order by time;
----
010300000001000000050000000000000000e072400000000000805940000000000020794000000000002079400000000000406940000000000020794000000000008059400000000000806b400000000000c06c400000000000005e40
0103000000010000000500000000000000004060400000000000005e400000000000e07a4000000000004079400000000000cc9f4000000000006079400000000000005b4000000000002072400000000000c077400000000000406040
01030000000100000005000000000000000000734000000000004059400000000000107940000000000010794000000000002069400000000000107940000000000040594000000000002069400000000000d072400000000000405940
01030000000100000005000000000000000020734000000000004060400000000000807b4000000000002079400000000000a0694000000000003079400000000000c0624000000000004069400000000000caa7400000000000805940
010300000001000000050000000000000000c06c400000000000406a400000000000a079400000000000407a400000000000406a400000000000407a400000000000005e400000000000806b400000000000e072400000000000805940
0103000000010000000500000000000000000074400000000000406040000000000040794000000000006079400000000000606940000000000020794000000000004060400000000000006e4000000000006073400000000000405a40
010300000001000000050000000000000000e072400000000000c059400000000000407a400000000000407940000000000040804000000000008061400000000000a079400000000000806b400000000000a074400000000000805940
010300000001000000050000000000000000a074400000000000a896400000000000c07c400000000000e07a400000000000406940000000000020794000000000004060400000000000006e400000000000e072400000000000c05940
010300000001000000050000000000000000e0724000000000004060400000000000e07a400000000000807b400000000000407a400000000000207c400000000000c06240000000000000a4400000000000f6a7400000000000002440
010300000001000000050000000000000000003e4000000000000024400000000000004440000000000000444000000000000034400000000000004440000000000000244000000000000034400000000000003e400000000000002440



query 
select st_AsBinary(loc3_MULTIPOINT) from gis_loc_all order by time;
----
010400000004000000010100000000000000008059400000000000004440010100000000000000000044400000000000003e4001010000000000000000003440000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000003440000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000003440000000000060694001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000e0754001010000000000000000003440000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000b0834001010000000000000000003440000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000003440000000000000344001010000000000000000003e400000000000a07940
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000005e40000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000806b40000000000000344001010000000000000000003e400000000000002440
01040000000400000001010000000000000000002440000000000000444001010000000000000000807b400000000000003e4001010000000000000000003440000000000000344001010000000000000000003e400000000000002440
010400000004000000010100000000000000000024400000000000004440010100000000000000000044400000000000003e4001010000000000000000003440000000000000344001010000000000000000003e400000000000806140



query 
select st_AsBinary(loc4_MULTILINESTRING) from gis_loc_all order by time;
----
0105000000020000000102000000030000000000000000002440000000000000244000000000000034400000000000003440000000000000244000000000000044400102000000040000000000000000807b4000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000002440
0105000000020000000102000000030000000000000000002440000000000000244000000000000034400000000000003440000000000000244000000000000044400102000000040000000000000000807b4000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000807b40010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000806140
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000008061400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000806140
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000e07a40000000000000444000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e400000000000807b4000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000006e40000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000002440
010500000002000000010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000004440010200000004000000000000000000444000000000000044400000000000003e400000000000003e40000000000000444000000000000034400000000000003e400000000000806140



query 
select st_AsBinary(loc5_MULTIPOLYGON) from gis_loc_all order by time;
----
010600000002000000010300000001000000040000000000000000003e400000000000003440000000000080464000000000000044400000000000002440000000000000444000000000004075400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000004a40
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000001040000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000000040010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000001040000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e400000000000003440000000000080464000000000000044400000000000002440000000000000444000000000000000000000000000003440010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000008041400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000024400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000384000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003a40010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000003440000000000000144000000000000024400000000000002e400000000000001440
010600000002000000010300000001000000040000000000000000003e40000000000000344000000000008046400000000000004440000000000000244000000000000044400000000000003e400000000000003440010300000001000000050000000000000000002e4000000000000014400000000000004440000000000000244000000000000024400000000000006e40000000000000144000000000000024400000000000002e400000000000001440


query 
select st_AsBinary(loc6_GEOMETRYCOLLECTION) from gis_loc_all order by time;
----
0107000000030000000101000000000000000000444000000000000024400102000000030000000000000000002440000000000000244000000000000034400000000000003440000000000000244000000000000044400103000000010000000400000000000000000044400000000000004440000000000000344000000000008046400000000000804640000000000040604000000000000044400000000000004440
01070000000300000001010000000000000000004440000000000000244001020000000300000000000000000024400000000000002440000000000000344000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e400000000000006e400000000000004440
0107000000030000000101000000000000000000444000000000000024400102000000030000000000000000002440000000000000f03f000000000000344000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000001040
01070000000300000001010000000000000000004440000000000000244001020000000300000000000000000031400000000000002440000000000000344000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
01070000000300000001010000000000000000004440000000000000244001020000000300000000000000000024400000000000000000000000000000344000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
010700000003000000010100000000000000000044400000000000002440010200000003000000000000000000244000000000000024400000000000003440000000000000344000000000000024400000000000207c4001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
01070000000300000001010000000000000000207940000000000000244001020000000300000000000000000024400000000000002440000000000000344000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
01070000000300000001010000000000000000004440000000000000244001020000000300000000000000000024400000000000002440000000000000344000000000000034400000000000c06240000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
010700000003000000010100000000000000000044400000000000406040010200000003000000000000000000244000000000000024400000000000806b4000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440
010700000003000000010100000000000000000044400000000000002440010200000003000000000000000000244000000000000024400000000000c06c4000000000000034400000000000002440000000000000444001030000000100000004000000000000000000444000000000000044400000000000003440000000000080464000000000008046400000000000003e4000000000000044400000000000004440


query 
select st_AsBinary(f0_bigint) from gis_loc_all order by time; 
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL


query 
select st_AsBinary(f1_bigint_unsign) from gis_loc_all order by time;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL


query 
select st_AsBinary(f2_boolean) from gis_loc_all order by time;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL



query 
select st_AsBinary(loc1_LINESTRING) from gis_loc_all order by time;
----
0102000000030000000000000000d07240000000000040594000000000004059400000000000d0724000000000001079400000000000107940
0102000000030000000000000000f072400000000000c059400000000000c059400000000000f0724000000000003079400000000000307940
0102000000030000000000000000e07240000000000040594000000000008059400000000000e0724000000000000046400000000000804640
0102000000030000000000000000d072400000000000003e400000000000004940000000000000414000000000000045400000000000804640
01020000000300000000000000008041400000000000003240000000000000334000000000000041400000000000003e400000000000407a40
01020000000300000000000000008040400000000000002840000000000000284000000000000042400000000000004e400000000000003e40
01020000000300000000000000000041400000000000003e4000000000008051400000000000004e4000000000008046400000000000805140
0102000000030000000000000000003e400000000000002a400000000000002440000000000000404000000000008044400000000000004640
0102000000030000000000000000003f4000000000000034400000000000002a40000000000000424000000000000049400000000000002440
0102000000030000000000000000003e40000000000000244000000000000024400000000000003e4000000000000044400000000000004440




query 
select st_AsBinary(f3_string) from gis_loc_all order by time;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL



query 
select st_AsBinary(f4_double) from gis_loc_all order by time;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
