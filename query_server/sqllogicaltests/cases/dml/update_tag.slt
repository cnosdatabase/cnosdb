include ./setup.slt

query T
select time, t0, t1, t2, f0, f1
from dml_tbl order by time, t0, t1, t2;
----
1999-12-31T00:00:00 tag11 tag21 NULL 111 444
1999-12-31T00:00:00.005 tag12 tag22 NULL 222 444
1999-12-31T00:00:00.010 tag12 tag23 NULL NULL 222
1999-12-31T00:00:10.015 tag14 tag24 NULL 444 111
1999-12-31T00:00:10.020 tag14 tag21 NULL 222 555
1999-12-31T00:10:00.025 tag11 tag22 NULL 333 555
1999-12-31T00:10:00.030 tag11 tag23 NULL 444 333
1999-12-31T01:00:00.035 tag14 tag24 NULL 555 222

statement error
update dml_tbl set t0 = null, t1 = null where t0 = 'tag12';

statement ok
update dml_tbl set t0 = 'tag_new11', t1 = 'tag_new21' where t0 = 'tag11' and t1 = 'tag21';

query T
select time, t0, t1, t2, f0, f1
from dml_tbl order by time, t0, t1, t2;
----
1999-12-31T00:00:00 tag_new11 tag_new21 NULL 111 444
1999-12-31T00:00:00.005 tag12 tag22 NULL 222 444
1999-12-31T00:00:00.010 tag12 tag23 NULL NULL 222
1999-12-31T00:00:10.015 tag14 tag24 NULL 444 111
1999-12-31T00:00:10.020 tag14 tag21 NULL 222 555
1999-12-31T00:10:00.025 tag11 tag22 NULL 333 555
1999-12-31T00:10:00.030 tag11 tag23 NULL 444 333
1999-12-31T01:00:00.035 tag14 tag24 NULL 555 222

statement ok
update dml_tbl set t0 = null, t1 = 'tag_new21' where t0 = 'tag_new11';

query T
select time, t0, t1, t2, f0, f1
from dml_tbl order by time, t0, t1, t2;
----
1999-12-31T00:00:00 NULL tag_new21 NULL 111 444
1999-12-31T00:00:00.005 tag12 tag22 NULL 222 444
1999-12-31T00:00:00.010 tag12 tag23 NULL NULL 222
1999-12-31T00:00:10.015 tag14 tag24 NULL 444 111
1999-12-31T00:00:10.020 tag14 tag21 NULL 222 555
1999-12-31T00:10:00.025 tag11 tag22 NULL 333 555
1999-12-31T00:10:00.030 tag11 tag23 NULL 444 333
1999-12-31T01:00:00.035 tag14 tag24 NULL 555 222

statement ok
update dml_tbl set t1 = 'xxxxx' where t0 = 'tag12' and t1 = 'tag22';

query T
select time, t0, t1, t2, f0, f1
from dml_tbl order by time, t0, t1, t2;
----
1999-12-31T00:00:00 NULL tag_new21 NULL 111 444
1999-12-31T00:00:00.005 tag12 xxxxx NULL 222 444
1999-12-31T00:00:00.010 tag12 tag23 NULL NULL 222
1999-12-31T00:00:10.015 tag14 tag24 NULL 444 111
1999-12-31T00:00:10.020 tag14 tag21 NULL 222 555
1999-12-31T00:10:00.025 tag11 tag22 NULL 333 555
1999-12-31T00:10:00.030 tag11 tag23 NULL 444 333
1999-12-31T01:00:00.035 tag14 tag24 NULL 555 222

statement ok
update dml_tbl set t2 = 'xxxxx' where t0 = 'tag12' and t1 = 'tag23';

query T
select time, t0, t1, t2, f0, f1
from dml_tbl order by time, t0, t1, t2;
----
1999-12-31T00:00:00 NULL tag_new21 NULL 111 444
1999-12-31T00:00:00.005 tag12 xxxxx NULL 222 444
1999-12-31T00:00:00.010 tag12 tag23 xxxxx NULL 222
1999-12-31T00:00:10.015 tag14 tag24 NULL 444 111
1999-12-31T00:00:10.020 tag14 tag21 NULL 222 555
1999-12-31T00:10:00.025 tag11 tag22 NULL 333 555
1999-12-31T00:10:00.030 tag11 tag23 NULL 444 333
1999-12-31T01:00:00.035 tag14 tag24 NULL 555 222

# set value not contains table column
statement error
update dml_tbl set t0 = t0 || 'xxx', t1 = 'tag_new21' where t0 = 'tag11';

# not contains time column
statement error
update dml_tbl set t0 = 'xxx', t1 = 'tag_new21' where t0 = 'tag11' and time < '1999-12-31T00:00:10.020';

# not contains field column
statement error
update dml_tbl set t0 = 'xxx', t1 = 'tag_new21' where t0 = 'tag11' and f1 = 222;
