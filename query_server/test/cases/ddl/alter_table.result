-- EXECUTE SQL: DROP DATABASE IF EXISTS alter_table; --
200 OK


-- EXECUTE SQL: CREATE DATABASE alter_table WITH TTL '100000d'; --
200 OK


-- EXECUTE SQL: CREATE TABLE test ( f0 BIGINT CODEC(NULL), TAGS(t0) ); --
200 OK


-- EXECUTE SQL: ALTER TABLE test DROP f0; --
422 Unprocessable Entity
{"error_code":"010032","error_message":"Semantic error: There must be at least one field column."}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test DROP t0; --
422 Unprocessable Entity
{"error_code":"010030","error_message":"Semantic error: Can't drop tag column t0."}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test DROP time; --
422 Unprocessable Entity
{"error_code":"010033","error_message":"Semantic error: There must be at least one tag column. "}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test ADD FIELD time BIGINT; --
422 Unprocessable Entity
{"error_code":"010028","error_message":"Semantic error:  column time already exists in table test"}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test ADD TAG t0; --
422 Unprocessable Entity
{"error_code":"010028","error_message":"Semantic error:  column t0 already exists in table test"}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test ADD FIELD f0 DOUBLE CODEC(DEFAULT); --
422 Unprocessable Entity
{"error_code":"010028","error_message":"Semantic error:  column f0 already exists in table test"}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test ADD TAG t1; --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
f0,BIGINT,FIELD,NULL
t1,STRING,TAG,DEFAULT

-- EXECUTE SQL: INSERT INTO test (TIME, t0, t1, f0) VALUES (1, '2', '3', 4), (5, '6', '7', 8); --
200 OK
rows
2

-- EXECUTE SQL: SELECT * FROM test ORDER BY TIME ASC; --
200 OK
time,t0,f0,t1
1970-01-01T00:00:00.000000001,2,4,3
1970-01-01T00:00:00.000000005,6,8,7

-- EXECUTE SQL: ALTER TABLE test ADD FIELD f1 BIGINT CODEC(NULL); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
f0,BIGINT,FIELD,NULL
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,NULL

-- EXECUTE SQL: INSERT INTO test (TIME, t0, t1, f0, f1) VALUES (9, '10', '11', 12, 13), (14, '15', '16', 17, 18); --
200 OK
rows
2

-- EXECUTE SQL: SELECT * FROM test ORDER BY TIME ASC; --
200 OK
time,t0,f0,t1,f1
1970-01-01T00:00:00.000000001,2,4,3,
1970-01-01T00:00:00.000000005,6,8,7,
1970-01-01T00:00:00.000000009,10,12,11,13
1970-01-01T00:00:00.000000014,15,17,16,18

-- EXECUTE SQL: ALTER TABLE test DROP f0; --
200 OK


-- EXECUTE SQL: ALTER TABLE test DROP f1; --
422 Unprocessable Entity
{"error_code":"010032","error_message":"Semantic error: There must be at least one field column."}
-- ERROR:  --

-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,NULL

-- EXECUTE SQL: SELECT * FROM test ORDER BY TIME ASC; --
200 OK
time,t0,t1,f1
1970-01-01T00:00:00.000000001,2,3,
1970-01-01T00:00:00.000000005,6,7,
1970-01-01T00:00:00.000000009,10,11,13
1970-01-01T00:00:00.000000014,15,16,18

-- EXECUTE SQL: ALTER TABLE test ADD FIELD f0 BIGINT CODEC(NULL); --
200 OK


-- EXECUTE SQL: SELECT * FROM test ORDER BY TIME ASC; --
200 OK
time,t0,t1,f1,f0
1970-01-01T00:00:00.000000001,2,3,,
1970-01-01T00:00:00.000000005,6,7,,
1970-01-01T00:00:00.000000009,10,11,13,
1970-01-01T00:00:00.000000014,15,16,18,

-- EXECUTE SQL: ALTER TABLE test ALTER f1 SET CODEC(DEFAULT); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,DEFAULT
f0,BIGINT,FIELD,NULL

-- EXECUTE SQL: SELECT * FROM test ORDER BY TIME ASC; --
200 OK
time,t0,t1,f1,f0
1970-01-01T00:00:00.000000001,2,3,,
1970-01-01T00:00:00.000000005,6,7,,
1970-01-01T00:00:00.000000009,10,11,13,
1970-01-01T00:00:00.000000014,15,16,18,

-- EXECUTE SQL: ALTER TABLE test ALTER t0 SET CODEC(NULL); --
422 Unprocessable Entity
{"error_code":"010034","error_message":"Semantic error: Tag does not support compression"}
-- ERROR:  --

-- EXECUTE SQL: ALTER TABLE test ALTER time SET CODEC(NULL); --
422 Unprocessable Entity
{"error_code":"010035","error_message":"Semantic error: Column time does not support modification"}
-- ERROR:  --

-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,DEFAULT
f0,BIGINT,FIELD,NULL

-- EXECUTE SQL: ALTER TABLE test ALTER f1 SET CODEC(DELTA); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,DELTA
f0,BIGINT,FIELD,NULL

-- EXECUTE SQL: ALTER TABLE test ALTER f1 SET CODEC(QUANTILE); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL

-- EXECUTE SQL: ALTER TABLE test ADD FIELD d0 DOUBLE CODEC(NULL); --
200 OK


-- EXECUTE SQL: ALTER TABLE test ADD FIELD s0 STRING CODEC(NULL); --
200 OK


-- EXECUTE SQL: ALTER TABLE test ADD FIELD b0 BOOLEAN CODEC(NULL); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,NULL
s0,STRING,FIELD,NULL
b0,BOOLEAN,FIELD,NULL

-- EXECUTE SQL: ALTER TABLE test ALTER d0 SET CODEC(GORILLA); --
200 OK


-- EXECUTE SQL: ALTER TABLE test ALTER s0 SET CODEC(SNAPPY); --
200 OK


-- EXECUTE SQL: ALTER TABLE test ALTER b0 SET CODEC(BITPACK); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,GORILLA
s0,STRING,FIELD,SNAPPY
b0,BOOLEAN,FIELD,BITPACK

-- EXECUTE SQL: ALTER TABLE test ALTER d0 SET CODEC(QUANTILE); --
200 OK


-- EXECUTE SQL: ALTER TABLE test ALTER s0 SET CODEC(ZSTD); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,QUANTILE
s0,STRING,FIELD,ZSTD
b0,BOOLEAN,FIELD,BITPACK

-- EXECUTE SQL: ALTER TABLE test ALTER s0 SET CODEC(GZIP); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,QUANTILE
s0,STRING,FIELD,GZIP
b0,BOOLEAN,FIELD,BITPACK

-- EXECUTE SQL: ALTER TABLE test ALTER s0 SET CODEC(BZIP); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,QUANTILE
s0,STRING,FIELD,BZIP
b0,BOOLEAN,FIELD,BITPACK

-- EXECUTE SQL: ALTER TABLE test ALTER s0 SET CODEC(ZLIB); --
200 OK


-- EXECUTE SQL: DESCRIBE TABLE test; --
200 OK
column_name,data_type,column_type,compression_codec
time,TIMESTAMP(NANOSECOND),TIME,DEFAULT
t0,STRING,TAG,DEFAULT
t1,STRING,TAG,DEFAULT
f1,BIGINT,FIELD,QUANTILE
f0,BIGINT,FIELD,NULL
d0,DOUBLE,FIELD,QUANTILE
s0,STRING,FIELD,ZLIB
b0,BOOLEAN,FIELD,BITPACK
