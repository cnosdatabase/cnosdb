namespace models;

table PingBody {
    payload: [ubyte];
}

enum FieldType: int {
    Unknown = -1,
    Float,
    Integer,
    Unsigned,
    Boolean,
    String,
}

struct RowKey {
    series_id: uint64;
    timestamp: uint64;
}

table RowField {
    field_id: uint64;
    type: FieldType;
    value: [ubyte];
}

table Row {
    key: RowKey;
    fields: [RowField];
}

enum WALEntryType: byte {
    Write = 1,
    Delete,
    DeleteRange,
}

table WriteWALEntry {
    rows: [Row];
}

struct DeleteWALEntryItem {
    series_id: uint64;
    field_id: uint64;
}

table DeleteWALEntry {
    items: [DeleteWALEntryItem];
}

table DeleteRangeWALEntry {
    items: [DeleteWALEntryItem];
    min: uint64;
    max: uint64;
}

union WALEntryUnion {
    Write: WriteWALEntry,
    Delete: DeleteWALEntry,
    DeleteRange: DeleteRangeWALEntry,
}

table WALEntry {
    seq: uint64;
    type: WALEntryType = Write;
    series_id: uint64;
    value: WALEntryUnion;
}